<!-- templates/orders/checkout_success.html -->

{% extends "base.html" %}
{% block content %}
  <div class="container mt-5">
    <h2>ðŸŽ‰ Order Confirmed</h2>

    {% if order %}
      <p>Thank you for your purchase{% if order.user %}, {{ order.user.username }}{% endif %}!</p>

      <h4>Order Summary:</h4>
      <ul class="list-unstyled">
        {% for item in order.items.all %}
          {% if item.product.type.name == "Bundle" %}
            {{ item.quantity }} Ã— <strong>{{ item.product.name }}</strong> (Bundle) â€“ Â£{{ item.unit_price }}
          {% else %}
            {{ item.quantity }} Ã— {{ item.product.name }} â€“ Â£{{ item.unit_price }}
          {% endif %}
        {% endfor %}
      </ul>

      <p><strong>Subtotal:</strong> Â£{{ order.total_price|floatformat:2 }}</p>
      {% if order.delivery_fee %}
        <p><strong>Delivery Fee:</strong> Â£{{ order.delivery_fee|floatformat:2 }}</p>
      {% endif %}
      {% if order.discount_total %}
        <p><strong>Discount Applied:</strong> Â£{{ order.discount_total|floatformat:2 }}</p>
      {% endif %}
      <p><strong>Paid Total:</strong> Â£{{ order.total_price|floatformat:2 }}</p>
    {% else %}
      <p>Your order has been received, but no details could be loaded. If you believe this is an error, please contact support.</p>
    {% endif %}

    <p>If you have any questions, please <a href="{{ contact_page_url }}">contact support</a> or email us at <a href="mailto:{{ support_email }}">{{ support_email }}</a>.</p>

    <a href="{% url 'products:product_list' %}" class="btn btn-primary mt-3">Continue Shopping</a>
  </div>
{% endblock %}
